/*****************************************
 * VAT - CIS470 Senior Project           *
 * SoftwareScan.cs                       *
 * Provides vulnerability news related   *
 *   to software installed on the system *
 *  *************************************/

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Management.Automation;

namespace VulnerabilityAssessmentTool
{
    public partial class SoftwareScan : Form
    {
        public SoftwareScan()
        {
            InitializeComponent();
        }

        // api call
        private void softwareScan()
        {
            var script = "get-date"; // PowerShell command here
            var powerShell = PowerShell.Create().AddScript(script); // Runs the script

            string returnedItems = "";

            foreach (dynamic item in powerShell.Invoke().ToList()) // Gets the results of the script
            {
                returnedItems += item + "\n";
            }

            lblTestBox.Text = returnedItems;
        }

        private void btnTest_Click(object sender, EventArgs e)
        {
            softwareScan();
        }
    }
}

# Have I Been Pwn API Caller


#Have to Add Inorder for Encoder to Work
Add-Type -AssemblyName System.Web

# To Use TLS 
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::
Tls12

#Actual Code
$Email = Read-Host -Prompt 'Input the email that you would like to check? '
$EncodedEmail = [System.Web.HttpUtility]::UrlEncode($Email)
$URI = "https://haveibeenpwned.com/api/v2/breachedaccount/$EncodedEmail"
$APICall =  Invoke-WebRequest -URI $URI -UserAgent Pwnage-Checker-For-Powershell
$BreachedData = $APICall.Content | ConvertFrom-Json
$BreachedData | select Name,Domain,BreachDate,DataClasses

[hashtable]$Return = @{}
$Return.ReturnCode = [int]1
$Return.ReturnString = [string]$Email, $BreachData
Return $Return
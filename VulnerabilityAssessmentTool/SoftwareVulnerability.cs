/*****************************************
 * VAT - CIS470 Senior Project           *
 * SoftwareVulnerability.c               *
 * Stores software vulnerability data    *
 *  *************************************/

using System;
using System.Collections.Generic;
using System.Data.OleDb;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VulnerabilityAssessmentTool
{
    class SoftwareVulnerability
    {
        DatabaseHelper db = new DatabaseHelper();   // Allows access to methods in DatabaseHelper class - use db.MethodName()

        // Members, getters, and setters
        public int id { get; set; }
        public string applicationName { get; set; }
        public string versionNumber { get; set; }
        public string installDate { get; set; }


        /* Gets the current software vulnerabilities stored in the database
         * ********************************************/
        public List<SoftwareVulnerability> getVulnerabilityList()
        {
            List<SoftwareVulnerability> vulnerabilityList = new List<SoftwareVulnerability>();    // Stores each vulnerability object pulled from database
            string query = "SELECT * FROM ApplicationList";
            OleDbCommand cmd = new OleDbCommand(query, db.conn);
            OleDbDataReader dr = cmd.ExecuteReader();

            while (dr.Read())   // Loop through results
            {
                SoftwareVulnerability vulnerability = new SoftwareVulnerability();  // Create new SoftwareVulnerability Object
                // Assign data to object variables
                vulnerability.id = Convert.ToInt16(dr["ID"]);
                vulnerability.applicationName = dr["Application"].ToString();
                vulnerability.versionNumber = dr["VersionNumber"].ToString();
                vulnerability.installDate = dr["InstallDate"].ToString();
                vulnerabilityList.Add(vulnerability);                               // Add vulnerability object to list
            }

            return vulnerabilityList;
        }

    } // End SoftwareVulnerability class
} // End namespace
